<!doctype html><html lang="nl"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Retourbewijs & Retourlabel – Printmodule (Pearle)</title><style>:root{--brand:#00836A;--w:210mm;--h:297mm;--pad:14mm;--font:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}html,body{margin:0;padding:0;font-family:var(--font)}.app{max-width:960px;margin:24px auto;padding:16px}.card{border:1px solid #ddd;border-radius:12px;padding:16px;box-shadow:0 2px 10px rgba(0,0,0,.04)}.row{display:flex;gap:12px;flex-wrap:wrap}.row>label{flex:1 1 260px;display:flex;flex-direction:column;font-size:14px}input,select,textarea{padding:10px;border-radius:8px;border:1px solid #ccc;font-size:16px}textarea{min-height:80px}.actions{display:flex;gap:12px;align-items:center;margin-top:16px;flex-wrap:wrap}.btn{background:var(--brand);color:#fff;border:0;border-radius:10px;padding:12px 16px;font-weight:600;cursor:pointer}.hint{font-size:12px;color:#555}.page{position:relative;width:var(--w);height:var(--h);page-break-after:always;background:#fff;overflow:hidden}.content{position:absolute;left:var(--pad);right:var(--pad);top:var(--pad)}.h1{font-size:20pt;font-weight:700;margin:0 0 10mm 0}.grid{display:grid;grid-template-columns:1fr 1fr;gap:6mm 12mm;font-size:12pt}.label{font-weight:700;margin-right:6px}.field{border-bottom:1px solid #000;padding:2mm 0;min-height:14pt}.subtext{font-size:10pt;margin-top:8mm;line-height:1.35}.signs{display:grid;grid-template-columns:1fr 1fr;gap:12mm;margin-top:14mm}.sign{border-top:1px solid #000;padding-top:4mm;text-align:center;font-size:10pt}.label-logo{position:absolute;top:25mm;left:50%;transform:translateX(-50%);width:95mm;height:auto}.label-note{position:absolute;left:10mm;bottom:10mm;font-size:10pt;opacity:.75}@media print{body{background:#fff}.app{display:none}@page{size:A4;margin:10mm}}</style></head><body><div class="app card"><h2 style="margin-top:0">Retourbewijs + Retourlabel printen</h2><p class="hint">Vul de gegevens in, kies de taal en klik op <b>Print</b>. Er worden automatisch <b>3</b> ontvangstbewijzen en <b>1</b> retourlabel geprint in één taak.</p><div class="row"><label>Taal / Langue<select id="lang"><option value="nl" selected>Nederlands</option><option value="fr">Français</option></select></label><label>Datum / Date<input id="date" type="date"/></label><label>Contractnummer / N° de contrat<input id="contract" type="text"/></label><label>Winkelnummer / N° de magasin<input id="store" type="text"/></label><label>Klantnummer / N° client<input id="customer" type="text"/></label><label>Peros order nummers / N° de commande Peros<textarea id="orders" placeholder="b.v. 12345, 67890"></textarea></label></div><div class="row"><label>Aantal ontvangstbewijzen (standaard 3)<input id="copiesReceipt" type="number" min="1" value="3"/></label><label>Aantal labels (standaard 1)<input id="copiesLabel" type="number" min="0" value="1"/></label></div><div class="actions"><button class="btn" id="printBtn">Print</button><button class="btn" id="previewBtn" type="button" title="Open in nieuw tabblad">Afdrukvoorbeeld</button><span class="hint">Tip: A4, staand, 100%, zonder kop-/voetteksten. Pop-ups toestaan voor deze site.</span></div></div><script>const LOGO_URL="https://grandvision.sharepoint.com/sites/NL2-AllEyes-PBE-NL/Shared%20Documents/Retail%20Support/TEST%20MAP%20-%20niets%20wissen/Retour%20logo%20Pearle.png",I18N={nl:{title:"Ontvangstbewijs",p1:"Wij bevestigen de ontvangst van de gehuurde producten. De eventuele betalingsverplichting van de openstaande bedragen en additionele kosten komen hiermee niet te vervallen. Wij verwijzen u voor meer informatie naar artikel 9 van de algemene voorwaarden Pearle Bril Plan.",date:"Datum",contract:"Contractnummer",store:"Winkelnummer",customer:"Klantnummer",orders:"Peros order nummers",sigCustomer:"Handtekening klant",sigStore:"Handtekening winkel",labelNote:"Retourlabel – plak op de verpakking"},fr:{title:"Accusé de réception",p1:"Nous confirmons la réception des produits loués. L'obligation de paiement des montants ouverts et des frais supplémentaires n'est pas annulée. Pour plus d'informations, voir l'article 9 des conditions générales du Pearle Bril Plan.",date:"Date",contract:"N° de contrat",store:"N° de magasin",customer:"N° client",orders:"N° de commande Peros",sigCustomer:"Signature client",sigStore:"Signature magasin",labelNote:"Étiquette de retour – à coller sur le colis"}},$=e=>document.getElementById(e);function collect(){return{lang:$("lang").value,date:$("date").value?new Date($("date").value).toLocaleDateString($("lang").value==="fr"?"fr-BE":"nl-BE"):"",contract:$("contract").value.trim(),store:$("store").value.trim(),customer:$("customer").value.trim(),orders:$("orders").value.trim(),copiesReceipt:Math.max(1,parseInt(($("copiesReceipt").value||"3"),10)),copiesLabel:Math.max(0,parseInt(($("copiesLabel").value||"1"),10))}}function openPrintWindow(e,t){const n=window.open("","_blank");if(!n){alert("Pop-up geblokkeerd. Sta pop-ups toe voor deze site en probeer opnieuw.");return}const a=I18N[e.lang],o=n.document;o.open(),o.write('<!doctype html><html><head><meta charset=\"utf-8\"><title>Print – Retour</title><style>@page{size:A4;margin:10mm}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}.page{position:relative;width:210mm;height:297mm;page-break-after:always;background:#fff;overflow:hidden}.content{position:absolute;left:14mm;right:14mm;top:14mm}.h1{font-size:20pt;font-weight:700;margin:0 0 10mm 0}.grid{display:grid;grid-template-columns:1fr 1fr;gap:6mm 12mm;font-size:12pt}.label{font-weight:700;margin-right:6px}.field{border-bottom:1px solid #000;padding:2mm 0;min-height:14pt}.subtext{font-size:10pt;margin-top:8mm;line-height:1.35}.signs{display:grid;grid-template-columns:1fr 1fr;gap:12mm;margin-top:14mm}.sign{border-top:1px solid #000;padding-top:4mm;text-align:center;font-size:10pt}.label-logo{position:absolute;top:25mm;left:50%;transform:translateX(-50%);width:95mm;height:auto}.label-note{position:absolute;left:10mm;bottom:10mm;font-size:10pt;opacity:.75}</style></head><body></body></html>'),o.close();function d(e,t){const n=o.createElement(e);return t&&(n.className=t),n}function l(){const e=d("section","page"),t=d("div","content"),n=d("h1","h1");n.textContent=a.title,t.appendChild(n);const l=d("div","grid");!function(e,t){const n=d("div"),a=d("span","label");a.textContent=e+": ";const o=d("div","field");o.textContent=t||"",n.appendChild(a),n.appendChild(o),l.appendChild(n)}(a.date,e.date),function(e,t){const n=d("div"),a=d("span","label");a.textContent=e+": ";const o=d("div","field");o.textContent=t||"",n.appendChild(a),n.appendChild(o),l.appendChild(n)}(a.contract,e.contract),function(e,t){const n=d("div"),a=d("span","label");a.textContent=e+": ";const o=d("div","field");o.textContent=t||"",n.appendChild(a),n.appendChild(o),l.appendChild(n)}(a.store,e.store),function(e,t){const n=d("div"),a=d("span","label");a.textContent=e+": ";const o=d("div","field");o.textContent=t||"",n.appendChild(a),n.appendChild(o),l.appendChild(n)}(a.customer,e.customer);const r=d("div");r.style.gridColumn="1 / span 2";const s=d("span","label");s.textContent=a.orders+": ";const i=d("div","field");i.textContent=e.orders||"",r.appendChild(s),r.appendChild(i),l.appendChild(r),t.appendChild(l);const c=d("div","subtext");c.textContent=a.p1,t.appendChild(c);const p=d("div","signs"),u=d("div","sign");u.textContent=a.sigCustomer;const m=d("div","sign");return m.textContent=a.sigStore,p.appendChild(u),p.appendChild(m),t.appendChild(p),e.appendChild(t),e}function r(){const e=d("section","page"),t=d("img","label-logo");t.alt="Pearle retourlogo",t.src=LOGO_URL,e.appendChild(t);const n=d("div","label-note");return n.textContent=a.labelNote,e.appendChild(n),e}for(let t=0;t<e.copiesReceipt;t++)o.body.appendChild(l());for(let t=0;t<e.copiesLabel;t++)o.body.appendChild(r());const g=o.images;let f=0,h=g.length;function y(){t&&(n.focus(),n.print())}if(h===0){y();return}for(let e=0;e<h;e++){const t=g[e];t.complete?++f===h&&y():(t.addEventListener("load",()=>{++f===h&&y()}),t.addEventListener("error",()=>{++f===h&&y()})}}}document.getElementById("printBtn").addEventListener("click",()=>{openPrintWindow(collect(),!0)}),document.getElementById("previewBtn").addEventListener("click",()=>{openPrintWindow(collect(),!1)})</script></body></html>